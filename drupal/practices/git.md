# Git

Drupal projects should be maintained using version control, such as Git.

# Git Branches

There should be matching git branches in relation to the environments defined on the hosting platform. For example:

- `develop` - Active development branch (pull request merge target)
- `master` - Stable branch of the site, should be clean and ready for hot fixes as needed
- `1.2.3` - Production releases should use git tags rather than a branch. Tags should be created directly from the latest commit on master after a new release merge.

In addition, there are a number of branching strategies that can be used by developers. [Git Flow](https://nvie.com/posts/a-successful-git-branching-model/) and [GitHub Flow](https://guides.github.com/introduction/flow/) are two such branching strategies.

For example, if using Git Flow, a developer would checkout the `develop` branch, pull the most recent changes, and then checkout a new branch off of that such as `feature/DELL-123--foobar`. They would then make their changes, commit them, and create a pull request against the `develop` branch.

Towards the end of the development sprint, the lead developer could then checkout a branch such as `release/1.2.3`, corresponding to the expected git tag that will be created for the new version. This branch would then have a new pull request created with `master` as the merge target. After it's merged, a new `1.2.3` git tag would be created, and the production environment would be updated to use the new tag.

# Drupal 8 .gitignore

Rather than committing the entire codebase to the git repository, you'll want to use the project's .gitignore file to ignore anything that's handled via composer (in addition to files that you normally wouldn't commit, such as settings.php). By not committing those files, you'll save a lot of time on conflicts caused by merging in updates from Drupal core and contributed modules, and the conflicts that instead occur in composer.lock are often easier to resolve.

For an example .gitignore structure, assuming that composer.json lives in the root of the repo and the project is stored in a folder named `web`:

```gitignore
# Ignore directories generated by Composer
/bin/
/console/language/
/drush/Commands/
/drush/contrib/
/vendor/
/docroot/core/
/docroot/modules/contrib/
/docroot/themes/contrib/
/docroot/profiles/contrib/
/docroot/libraries/

# Ignore databases.
*.sql
*.sql.gz

# Ignore sensitive information
/docroot/sites/*/settings.local.php
/docroot/sites/*/settings.ddev.php

# Ignore services configuration
/docroot/sites/*/services.yml

# Ignore SimpleTest multi-site environment.
/docroot/sites/simpletest

# Ignore files generated by PhpStorm
/.idea/

# Ignore .env files as they are personal
/.env

# Ignore build directories
build

.editorconfig
.gitattributes

# Ignore local drush configuration.
/drush/drush.yml

# Ignore paths that contain user-generated content.
/docroot/files
/docroot/sites/*/files
/docroot/sites/*/private
```